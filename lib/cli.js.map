{"version":3,"file":"cli.js","sources":["../src/cli.js"],"sourcesContent":["#!/usr/bin/env node\n\nconst path = require(\"path\");\nconst sade = require(\"sade\");\nconst qunit = require(\"./index\");\n\nconst program = sade(\"qunit-coverage\");\n\nprogram.version(\"0.4.0\"); // TODO: How to keep this up to date?\n\nprogram\n\t.command(\"test <file>\", \"\", { default: true })\n\t.option(\"-c, --coverage\", \"Evaulate Istanbul coverage\", true)\n\t.option(\"-v, --verbose\", \"Perform additional logging\", true)\n\t.option(\"-t, --timeout\", \"Set a timeout to fail the process after\", 5000)\n\t.option(\"-o, --output\", \"Set an output directory for additional coverage format outputs\", \".\")\n\t.option(\"-f, --formats\", \"Output test coverage in different formats\")\n\t.option(\"-p, --puppeteer-options\", \"Passes options to puppeteer on launch\")\n\t.describe(\"Runs the QUnit test runner for the given fixture.\")\n\t.example(\"qunit-coverage test/fixture.html\")\n\t.example(\"qunit-coverage test/fixture.html -o coverage -f json,html\")\n\t.example(\"qunit-coverage test test/fixture.html\")\n\t.action(async (file, options) => {\n\t\ttry {\n\t\t\tconst formats = options.formats ? options.formats.split(\",\").filter(format => format) : [];\n\t\t\tconst coverage = formats.length && options.coverage ? { output: path.resolve(options.output), formats } : options.coverage;\n\n\t\t\tlet puppeteerOptions = {};\n\n\t\t\ttry {\n\t\t\t\tpuppeteerOptions = JSON.parse(options.p || \"{}\");\n\t\t\t} catch (ex) {\n\t\t\t\tconsole.log();\n\t\t\t\tconsole.log(ex.message);\n\t\t\t\tconsole.log();\n\t\t\t}\n\n\t\t\tconst results = await qunit(file, { verbose: options.verbose, timeout: options.timeout, coverage, puppeteerOptions });\n\n\t\t\tprocess.exit(results.pass ? 0 : 1);\n\t\t} catch (ex) {\n\t\t\t// TODO: Log the exception?\n\t\t\tprocess.exit(1);\n\t\t}\n\t});\n\nprogram.parse(process.argv);\n"],"names":["const","path","require","sade","qunit","program","version","command","default","option","describe","example","action","file","options","ex","process","exit","coverage","formats","split","filter","format","length","output","resolve","puppeteerOptions","JSON","parse","p","console","log","message","verbose","timeout","then","$await_3","pass","argv"],"mappings":";AAEAA,IAAMC,EAAOC,QAAQ,QACfC,EAAOD,QAAQ,QACfE,EAAQF,QAAQ,WAEhBG,EAAUF,EAAK,kBAErBE,EAAQC,QAAQ,SAEhBD,EACEE,QAAQ,cAAe,IAAMC,SAAS,IACtCC,OAAO,iBAAkB,8BAA8B,GACvDA,OAAO,gBAAiB,8BAA8B,GACtDA,OAAO,gBAAiB,0CAA2C,KACnEA,OAAO,eAAgB,iEAAkE,KACzFA,OAAO,gBAAiB,6CACxBA,OAAO,0BAA2B,yCAClCC,SAAS,qDACTC,QAAQ,oCACRA,QAAQ,6DACRA,QAAQ,yCACRC,gBAAcC,EAAMC,sGAkBXC,cAERC,QAAQC,KAAK,8BAnBd,cAEOC,GADAC,EAAUL,EAAQK,QAAUL,EAAQK,QAAQC,MAAM,KAAKC,gBAAOC,UAAUA,QACrDC,QAAUT,EAAQI,UAAaM,OAAQvB,EAAKwB,QAAQX,EAAQU,gBAASL,GAAYL,EAAQI,SAE9GQ,KAEJ,IACCA,EAAmBC,KAAKC,MAAMd,EAAQe,GAAK,YACnCd,GACRe,QAAQC,MACRD,QAAQC,IAAIhB,EAAGiB,SACfF,QAAQC,MAGO,OAAM3B,EAAMS,GAAQoB,QAASnB,EAAQmB,QAASC,QAASpB,EAAQoB,iBAAShB,mBAAUQ,IAAlFS,4BAEhBnB,QAAQC,KAFQmB,EAEKC,KAAO,EAAI,sCACxBtB,YAMXV,EAAQuB,MAAMZ,QAAQsB"}